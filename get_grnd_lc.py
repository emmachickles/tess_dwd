# Download or locate ATLAS and ZTF light curves

import lc_utils as lcu
import os
import pdb

gaia_tab = "/home/echickle/data/100pc_clean.fits"
wd_tab = "/home/echickle/data/WDs.txt"
atlas_dir = "/data/ATLAS/"
out_dir = "/home/echickle/data/grnd_lc/"
out = open(out_dir + "s0061-cam1.txt", "w")
out.write("TICID,CATALOG,FNAME\n")

fnames = ['wid_29_pow_11.175058_snr_0.12944_per_25.64813_TIC0000000754957724_cam_1_ccd_1_dur_0.09090909_epo_0.51515156_ra_119.68515830855_dec_-3.04965004725_phase_curve.png', 'wid_12_pow_8.686864_snr_0.23057_per_70.85747_TIC0000000755200458_cam_1_ccd_1_dur_0.02173913_epo_0.02173913_ra_117.51599517275_dec_0.12763613213_phase_curve.png', 'wid_9_pow_9.465144_snr_0.25537_per_10.7292_TIC0000000755024789_cam_1_ccd_1_dur_0.023809524_epo_0.42857143_ra_115.63168585913_dec_-2.22510952883_phase_curve.png', 'wid_11_pow_9.574354_snr_0.20893_per_12.35618_TIC0000000755054313_cam_1_ccd_1_dur_0.05263158_epo_0.22807018_ra_118.79262186423_dec_-1.5264232671_phase_curve.png', 'wid_10_pow_117.502975_snr_0.90613_per_174.2141_TIC0000000803489769_cam_1_ccd_1_dur_0.023809524_epo_0.21428572_ra_121.17488619979_dec_-2.26253492655_phase_curve.png', 'wid_14_pow_37.74368_snr_0.33903_per_8.88907_TIC0000000754984562_cam_1_ccd_1_dur_0.010638298_epo_0.8404255_ra_118.8871411275_dec_-1.78554163343_phase_curve.png', 'wid_15_pow_12.05825_snr_0.20198_per_9.5809_TIC0000000755007999_cam_1_ccd_1_dur_0.030303031_epo_0.3030303_ra_117.08183559093_dec_-2.67504248702_phase_curve.png', 'wid_11_pow_9.940201_snr_0.17192_per_10.86086_TIC0000000836033167_cam_1_ccd_1_dur_0.045454547_epo_0.45454547_ra_123.38667416993_dec_-11.4702153666_phase_curve.png', 'wid_10_pow_10.829989_snr_0.27439_per_9.07523_TIC0000000755214219_cam_1_ccd_1_dur_0.025641026_epo_0.7692308_ra_116.19981624721_dec_0.36631943402_phase_curve.png', 'wid_8_pow_8.88976_snr_0.24563_per_7.44588_TIC0000000803852871_cam_1_ccd_1_dur_0.02173913_epo_0.7173913_ra_120.04952985372_dec_-1.45654140585_phase_curve.png', 'wid_19_pow_8.941142_snr_0.22476_per_24.71703_TIC0000000755224560_cam_1_ccd_1_dur_0.035714287_epo_0.23809525_ra_116.38898016943_dec_0.84949599802_phase_curve.png', 'wid_10_pow_9.223532_snr_0.16791_per_7.71867_TIC0000000755035132_cam_1_ccd_1_dur_0.035714287_epo_0.1904762_ra_117.05053463845_dec_-1.52636694638_phase_curve.png', 'wid_12_pow_9.52494_snr_0.20287_per_7.62223_TIC0000000755216985_cam_1_ccd_1_dur_0.05882353_epo_0.21568628_ra_116.99996472621_dec_0.31741312848_phase_curve.png', 'wid_15_pow_8.76201_snr_0.16398_per_10.41067_TIC0000000755301147_cam_1_ccd_1_dur_0.05_epo_0.2_ra_116.32061061827_dec_0.95127080564_phase_curve.png', 'wid_8_pow_10.825268_snr_0.24253_per_8.19767_TIC0000000755056336_cam_1_ccd_1_dur_0.027777778_epo_0.37962964_ra_119.22734638087_dec_-1.42351689182_phase_curve.png', 'wid_11_pow_8.507903_snr_0.19457_per_47.61053_TIC0000000803454388_cam_1_ccd_1_dur_0.02173913_epo_0.6304348_ra_126.11537307001_dec_-2.01659526362_phase_curve.png','wid_5_pow_9.3097_snr_0.30746_per_10.19656_TIC0000000836946313_cam_1_ccd_2_dur_0.012658228_epo_0.6329114_ra_127.72644045246_dec_-7.82229290926_phase_curve.png', 'wid_10_pow_8.84518_snr_0.12886_per_25.04822_TIC0000000836299997_cam_1_ccd_2_dur_0.05_epo_0.65000004_ra_134.50852140569_dec_-14.11246178904_phase_curve.png', 'wid_7_pow_8.377624_snr_0.11517_per_10.4996_TIC0000000836726020_cam_1_ccd_2_dur_0.023809524_epo_0.6666667_ra_130.95115883051_dec_-9.62287744504_phase_curve.png', 'wid_10_pow_11.229839_snr_0.38315_per_15.44586_TIC0000000836732572_cam_1_ccd_2_dur_0.013888889_epo_0.06944445_ra_129.78061671618_dec_-9.46576567855_phase_curve.png', 'wid_18_pow_9.708613_snr_0.16308_per_15.84275_TIC0000000836871831_cam_1_ccd_2_dur_0.071428575_epo_0.71428573_ra_126.64165031002_dec_-8.69283204914_phase_curve.png', 'wid_5_pow_10.317205_snr_0.34444_per_18.08757_TIC0000000803184423_cam_1_ccd_2_dur_0.013888889_epo_0.3101852_ra_127.51703224855_dec_-5.68947955403_phase_curve.png', 'wid_11_pow_8.846396_snr_0.18595_per_9.11798_TIC0000000050719966_cam_1_ccd_2_dur_0.05263158_epo_0.2631579_ra_126.53555924107_dec_-8.9082742232_phase_curve.png', 'wid_19_pow_9.0464115_snr_0.15689_per_12.81046_TIC0000000803585416_cam_1_ccd_2_dur_0.06666667_epo_0.06666667_ra_128.42131001757_dec_-1.73417525865_phase_curve.png', 'wid_8_pow_9.914058_snr_0.19074_per_24.10044_TIC0000000803575885_cam_1_ccd_2_dur_0.025641026_epo_0.62393165_ra_128.52593484929_dec_-2.26483692848_phase_curve.png', 'wid_21_pow_10.978252_snr_0.14062_per_8.04691_TIC0000000836819708_cam_1_ccd_2_dur_0.083333336_epo_0.6944445_ra_127.91892871306_dec_-9.46191966583_phase_curve.png', 'wid_10_pow_8.814607_snr_0.16867_per_12.49324_TIC0000000837039465_cam_1_ccd_2_dur_0.045454547_epo_0.74242425_ra_133.90520761297_dec_-6.39597635859_phase_curve.png', 'wid_8_pow_8.986504_snr_0.26274_per_53.32296_TIC0000000803181773_cam_1_ccd_2_dur_0.015151516_epo_0.73737377_ra_127.35874353072_dec_-5.90392468379_phase_curve.png', 'wid_5_pow_9.184603_snr_0.22905_per_27.42599_TIC0000000836792529_cam_1_ccd_2_dur_0.02173913_epo_0.9927536_ra_126.36153376929_dec_-10.36126369808_phase_curve.png', 'wid_8_pow_8.537788_snr_0.26743_per_9.78998_TIC0000000803214514_cam_1_ccd_2_dur_0.027777778_epo_0.037037037_ra_127.61439080776_dec_-4.6722178648_phase_curve.png', 'wid_13_pow_10.482865_snr_0.25917_per_17.68136_TIC0000000835938474_cam_1_ccd_2_dur_0.035714287_epo_0.7261905_ra_126.01679226682_dec_-11.64407281081_phase_curve.png', 'wid_7_pow_9.841505_snr_0.25565_per_8.24449_TIC0000000803584875_cam_1_ccd_2_dur_0.025641026_epo_0.82051283_ra_128.38330815717_dec_-2.02527702825_phase_curve.png', 'wid_15_pow_9.820688_snr_0.14436_per_24.18049_TIC0000000803221136_cam_1_ccd_2_dur_0.071428575_epo_0.023809526_ra_127.82313896116_dec_-4.2425896617_phase_curve.png', 'wid_11_pow_10.816936_snr_0.28045_per_13.5304_TIC0000000803568171_cam_1_ccd_2_dur_0.02173913_epo_0.8768116_ra_128.06389270295_dec_-3.07608254059_phase_curve.png', 'wid_15_pow_9.450719_snr_0.17672_per_73.28342_TIC0000000836417687_cam_1_ccd_2_dur_0.055555556_epo_0.9074074_ra_133.72293295925_dec_-12.77573408178_phase_curve.png', 'wid_18_pow_10.005284_snr_0.24017_per_17.97163_TIC0000000836792451_cam_1_ccd_2_dur_0.045454547_epo_0.3181818_ra_126.19215869247_dec_-10.40891848874_phase_curve.png', 'wid_7_pow_10.734093_snr_0.2467_per_7.81162_TIC0000000803575284_cam_1_ccd_2_dur_0.030303031_epo_0.7676768_ra_128.35553103753_dec_-2.60756054553_phase_curve.png', 'wid_5_pow_10.682923_snr_0.39898_per_9.21434_TIC0000000836956403_cam_1_ccd_2_dur_0.012658228_epo_0.721519_ra_127.06567248107_dec_-7.36481693593_phase_curve.png', 'wid_8_pow_10.225686_snr_0.27193_per_8.17692_TIC0000000800113200_cam_1_ccd_3_dur_0.02173913_epo_0.5797102_ra_131.71867036236_dec_5.02606697809_phase_curve.png', 'wid_19_pow_8.437733_snr_0.13049_per_7.68226_TIC0000000804371582_cam_1_ccd_3_dur_0.1_epo_0.16666667_ra_136.72496646948_dec_-0.97768017513_phase_curve.png', 'wid_58_pow_72.73888_snr_0.53801_per_93.73281_TIC0000000800042858_cam_1_ccd_3_dur_0.1_epo_0.6_ra_134.442437099_dec_3.71537555667_phase_curve.png', 'wid_6_pow_11.285484_snr_0.26757_per_104.00397_TIC0000000842105238_cam_1_ccd_3_dur_0.030303031_epo_0.26262626_ra_141.24602051245_dec_0.29165606282_phase_curve.png', 'wid_6_pow_30.335266_snr_0.20642_per_26.65789_TIC0000000804385701_cam_1_ccd_3_dur_0.012658228_epo_0.35021096_ra_136.6010707453_dec_-0.40780817939_phase_curve.png', 'wid_11_pow_8.596663_snr_0.18916_per_9.64001_TIC0000000842104931_cam_1_ccd_3_dur_0.05_epo_0.68333334_ra_141.26538395492_dec_0.0765777371_phase_curve.png', 'wid_10_pow_9.556522_snr_0.23262_per_19.10301_TIC0000000803667512_cam_1_ccd_3_dur_0.02173913_epo_0.05072464_ra_132.10677611836_dec_1.83722338716_phase_curve.png', 'wid_15_pow_9.328247_snr_0.11162_per_6.88161_TIC0000000840008811_cam_1_ccd_3_dur_0.125_epo_0.041666668_ra_142.63158818195_dec_6.70354147989_phase_curve.png', 'wid_9_pow_10.287796_snr_0.29199_per_49.99237_TIC0000000800282483_cam_1_ccd_3_dur_0.011627907_epo_0.61627907_ra_133.28535818931_dec_8.28593612764_phase_curve.png', 'wid_8_pow_11.790852_snr_0.39131_per_14.72404_TIC0000000842127763_cam_1_ccd_3_dur_0.012658228_epo_0.77215195_ra_141.72335946365_dec_2.58068943444_phase_curve.png', 'wid_6_pow_10.2503605_snr_0.27688_per_27.48901_TIC0000000804368877_cam_1_ccd_3_dur_0.025641026_epo_0.094017096_ra_138.19441802961_dec_-1.04691549691_phase_curve.png', 'wid_7_pow_9.481827_snr_0.21928_per_7.6587_TIC0000000842202832_cam_1_ccd_3_dur_0.033333335_epo_0.6777778_ra_141.95860890944_dec_3.64603230792_phase_curve.png', 'wid_26_pow_8.972524_snr_0.12268_per_31.4344_TIC0000000471013988_cam_1_ccd_3_dur_0.125_epo_0.9583333_ra_142.629125_dec_6.31468889_phase_curve.png', 'wid_10_pow_10.830033_snr_0.287_per_9.39444_TIC0000000804410631_cam_1_ccd_3_dur_0.018181818_epo_0.5030303_ra_139.86649955075_dec_2.95193364313_phase_curve.png', 'wid_7_pow_8.971176_snr_0.31325_per_17.22401_TIC0000000842129159_cam_1_ccd_3_dur_0.011627907_epo_0.3875969_ra_141.72637104688_dec_2.67992979025_phase_curve.png', 'wid_57_pow_62.462574_snr_0.2351_per_107.5948_TIC0000000270679102_cam_1_ccd_3_dur_0.14285715_epo_0.095238104_ra_137.05015889229_dec_6.07252377646_phase_curve.png', 'wid_12_pow_11.209418_snr_0.26644_per_8.40246_TIC0000000804403699_cam_1_ccd_3_dur_0.027777778_epo_0.22222222_ra_139.4931972177_dec_1.32383936695_phase_curve.png', 'wid_12_pow_10.780592_snr_0.13642_per_18.10055_TIC0000000840001066_cam_1_ccd_3_dur_0.083333336_epo_0.3888889_ra_140.48600197996_dec_5.04440706449_phase_curve.png', 'wid_13_pow_10.234654_snr_0.18475_per_33.38528_TIC0000000803762345_cam_1_ccd_3_dur_0.03846154_epo_0.5769231_ra_129.88558483385_dec_1.29208376697_phase_curve.png', 'wid_13_pow_13.005671_snr_0.31059_per_36.67344_TIC0000000803643569_cam_1_ccd_3_dur_0.015151516_epo_0.14141415_ra_131.15516804767_dec_-0.13022084461_phase_curve.png', 'wid_11_pow_10.739921_snr_0.11705_per_20.81045_TIC0000000804377856_cam_1_ccd_3_dur_0.05263158_epo_0.8947368_ra_139.92659685248_dec_-0.09279130374_phase_curve.png', 'wid_6_pow_30.335266_snr_0.20642_per_26.65789_TIC0000000804385701_cam_1_ccd_3_dur_0.012658228_epo_0.35021096_ra_136.6010707453_dec_-0.40780817939_phase_curve copy.png', 'wid_26_pow_8.676317_snr_0.09393_per_11.41373_TIC0000000804376421_cam_1_ccd_3_dur_0.1_epo_0.8666667_ra_139.02812330849_dec_-0.61148938741_phase_curve.png', 'wid_7_pow_8.99448_snr_0.25342_per_17.43586_TIC0000000804361259_cam_1_ccd_3_dur_0.02173913_epo_0.014492754_ra_139.54693049849_dec_-1.57739153689_phase_curve.png', 'wid_8_pow_9.479117_snr_0.18171_per_8.11424_TIC0000000804250447_cam_1_ccd_4_dur_0.030303031_epo_0.2828283_ra_121.47243087065_dec_7.23535684558_phase_curve.png', 'wid_14_pow_8.731139_snr_0.17817_per_28.95074_TIC0000000803771561_cam_1_ccd_4_dur_0.05882353_epo_0.5294118_ra_129.07232476851_dec_1.96841572065_phase_curve.png', 'wid_10_pow_9.546938_snr_0.20908_per_80.95583_TIC0000000800240933_cam_1_ccd_4_dur_0.033333335_epo_0.18888889_ra_130.15315047082_dec_6.62263223307_phase_curve.png', 'wid_14_pow_9.305201_snr_0.19339_per_6.9366_TIC0000000800250369_cam_1_ccd_4_dur_0.05263158_epo_0.61403507_ra_130.55528433165_dec_7.95228828157_phase_curve.png', 'wid_9_pow_9.984263_snr_0.21933_per_103.59689_TIC0000000803700865_cam_1_ccd_4_dur_0.05263158_epo_0.54385966_ra_128.62025425385_dec_0.47509239419_phase_curve.png', 'wid_13_pow_9.314626_snr_0.13315_per_8.52244_TIC0000000803708165_cam_1_ccd_4_dur_0.071428575_epo_0.0952381_ra_128.01195044376_dec_0.56739107008_phase_curve.png', 'wid_8_pow_12.049984_snr_0.27492_per_15.56023_TIC0000000800349196_cam_1_ccd_4_dur_0.02_epo_0.15333334_ra_128.2892785129_dec_10.08124084707_phase_curve.png', 'wid_37_pow_104.42451_snr_2.04829_per_138.58794_TIC0000000455206965_cam_1_ccd_4_dur_0.1_epo_0.16666667_ra_125.22306633609_dec_0.14541671625_phase_curve.png', 'wid_25_pow_9.373624_snr_0.10414_per_7.79598_TIC0000000804312587_cam_1_ccd_4_dur_0.14285715_epo_0.6666667_ra_123.02191141887_dec_10.10315158873_phase_curve.png', 'wid_19_pow_8.970038_snr_0.14074_per_9.61071_TIC0000000803696983_cam_1_ccd_4_dur_0.09090909_epo_0.90909094_ra_128.48310222921_dec_-0.31475135112_phase_curve.png', 'wid_31_pow_78.45499_snr_0.52003_per_113.93821_TIC0000000452954413_cam_1_ccd_4_dur_0.083333336_epo_0.47222224_ra_122.07905627863_dec_0.98336148012_phase_curve.png', 'wid_7_pow_9.899372_snr_0.20576_per_7.17281_TIC0000000803809039_cam_1_ccd_4_dur_0.025641026_epo_0.82905984_ra_129.17159055728_dec_2.83692727844_phase_curve.png', 'wid_12_pow_10.569384_snr_0.13295_per_8.49874_TIC0000000800305162_cam_1_ccd_4_dur_0.0625_epo_0.9375_ra_130.9388741757_dec_9.67904584753_phase_curve.png', 'wid_20_pow_9.596467_snr_0.14253_per_10.52205_TIC0000000760223912_cam_1_ccd_4_dur_0.0625_epo_0.22916667_ra_119.09945117126_dec_6.46916809194_phase_curve.png', 'wid_10_pow_10.490755_snr_0.16877_per_11.28698_TIC0000000804347188_cam_1_ccd_4_dur_0.030303031_epo_0.8181819_ra_120.30346819684_dec_11.52562563332_phase_curve.png', 'wid_10_pow_10.13663_snr_0.18716_per_58.91984_TIC0000000800247717_cam_1_ccd_4_dur_0.045454547_epo_0.33333334_ra_130.28707387102_dec_7.54309738442_phase_curve.png', 'wid_8_pow_9.370736_snr_0.16807_per_8.88724_TIC0000000755479768_cam_1_ccd_4_dur_0.041666668_epo_0.84722227_ra_119.55187102853_dec_4.12985865125_phase_curve.png', 'wid_9_pow_9.534854_snr_0.19669_per_7.02419_TIC0000000803990820_cam_1_ccd_4_dur_0.033333335_epo_0.4555556_ra_122.20326655959_dec_1.35415600174_phase_curve.png', 'wid_13_pow_9.9675665_snr_0.23337_per_41.15812_TIC0000000803790211_cam_1_ccd_4_dur_0.033333335_epo_0.24444446_ra_128.31694282058_dec_1.78975785417_phase_curve.png', 'wid_12_pow_9.369285_snr_0.15404_per_10.65428_TIC0000000804139604_cam_1_ccd_4_dur_0.03846154_epo_0.012820514_ra_120.28275617634_dec_4.15761897775_phase_curve.png', 'wid_13_pow_10.569551_snr_0.19964_per_22.85763_TIC0000000804346560_cam_1_ccd_4_dur_0.05_epo_0.56666666_ra_121.00878815782_dec_11.8021104768_phase_curve.png', 'wid_9_pow_9.66095_snr_0.22586_per_6.95563_TIC0000000804007148_cam_1_ccd_4_dur_0.013888889_epo_0.4212963_ra_121.72754034595_dec_2.3735984227_phase_curve.png', 'wid_10_pow_11.563087_snr_0.34275_per_10.59151_TIC0000000804047091_cam_1_ccd_4_dur_0.016666668_epo_0.7777778_ra_127.16650328919_dec_3.45997063219_phase_curve.png', 'wid_9_pow_10.385145_snr_0.25045_per_11.06976_TIC0000000803692261_cam_1_ccd_4_dur_0.030303031_epo_0.72727275_ra_127.9251597001_dec_-0.85525409304_phase_curve.png', 'wid_7_pow_9.1959715_snr_0.24271_per_28.84492_TIC0000000760314926_cam_1_ccd_4_dur_0.030303031_epo_0.8585859_ra_119.84286690913_dec_9.50625157105_phase_curve.png']

for i in range(len(fnames)):
    fname = fnames[i].split("_")
    ticid, ra, dec = int(fname[8][3:]), float(fname[18]), float(fname[20])
    fname = "_".join(fname)
    out.write("{},{},{}\n".format(ticid, "TESS", fname))
    
    fpath = lcu.get_atlas_lc(ticid, wd_tab, atlas_dir)
    if type(fpath) == type(""):
        fname = fpath.split("/")[-1]
        os.system("cp "+fpath+" "+out_dir+fname)
        out.write("{},{},{}\n".format(ticid, "ATLAS", fname))

    fpaths = lcu.get_ztf_lc(ra, dec)
    for j in range(len(fpaths)):
        fpath = fpaths[j]
        fname = fpath.split("/")[-1]
        os.system("mv "+fpath+" "+out_dir+fname)
        out.write("{},{},{}\n".format(ticid, "ZTF", fname))    

out.close()
